# 데이터 중심 애플리케이션 설계

## 신뢰성
- 결함(fault): 잘못될 수 있는 일. 사양에서 벗어난 시스템의 한 구성 요소
- 장애(failure): 사용자에게 필요한 서비스를 제공하지 못하고 시스템 전체가 멈춘 경우   

내결함성 구조: 결함으로 인해 장애가 발생하지 않도록 설계된 구조

### 하드웨어 결함
클라우드 플랫폼을 통한 가상 장비 인스턴스는 별도의 경고 없이 사용할 수 없게 되는 문제가 자주 발생한다.  
(유연성, 탄력성 위주로 설계되었기 때문)   
=> 내결함성 기술을 사용하거나 하드웨어 중복성을 추가해 전체 장비의 손실을 견딜 수 있도록 한다.

### 소프트웨어 오류
체계적 오류(systematic error)
- CPU 시간, 메모리, 디스크 공간, 네트워크 대역폭 등 자원을 과도하게 점유하는 서비스  
- 시스템의 속도가 느려서 반응이 없거나 잘못된 응답을 반환하는 서비스
- 연쇄 장애(cascading failure)
=> 모니터링, 테스트, 프로세스 격리 등

### 인적 오류
운영자 설정 오류 등
=> API, 샌드박스, 충분한 테스트, 쉬운 롤백, 원격 측정(telemetry), 조작 교육/실습

## 확장성
부하에 대처하는 시스템 능력  
부하 매개변수(load parameter): 초당 요청 수, DB 읽기 대 쓰기 비율, active user, 캐시 적중률 등  

### 성능
일반적으로 백분위를 사용하는 편이 좋다.   
- 중앙값(median): p50
- 상위 백분위: p95, p99, p999: 각각 95%, 99%, 99.9%
서비스 수준 목표(Service Level objective, SLO)와 서비스 수준 협약서(Service Level agreement, SLA)에 자주 사용  
ex) 중앙값이 200ms 미만이고 p99가 1s 미만인 경우 정상 서비스 상태로 간주한다.  

선두차단: 소수의 느린 요청 처리로 후속 요청 처리가 지체되는 현상  

### 부하 대응 접근 방식
- scaling up: 장비를 업그레이드  
- scaling out: 다수의 장비로 부하를 분산
=> 대용량 데이터/트래픽을 다루지 않는 사용 사례에도 분산 데이터 시스템이 향후 기본 아키텍처로 자리 잡을 가능성이 있다.

## 유지보수성
버그 수정, 시스템 운영 유지, 장애 조사, 새로운 플랫폼 적용, 기술 채무 상환, 새로운 기능 등  

- 운용성: 운영팀이 시스템을 월활하게 운영할 수 있도록 쉽게 만들어라  
    - 시스템 상태를 모니터링하고 상태가 좋지 않다면 서비스 복원
    - 시스템 장애, 성능 저하 등의 문제의 원인을 추적
    - 배포, 설정 관리 등을 위한 모범 사례와 도구를 마련
    - 개인 인사 이동에도 시스템에 대한 조직의 지식을 보존함

- 단순성: 시스템에서 복잡성을 최대한 제거해 새로운 엔지니어가 이해하기 쉽게 만들어라.  
모듈 간 강한 커플링, 복잡한 의존성, 일관성 없는 naming, 임시방편 등으로 복잡도 증가  
=> 추상화를 통해 해결  

- 발전성: 엔지니어가 이후에 시스템을 변경할 수 있게 하라(유연성, 수정 가능성, 적응성)  
애자일 작업 패턴(TDD, 리팩토링) 기법